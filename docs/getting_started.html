
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Getting started &#8212; gossipy 0.0.1 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API documentation" href="api/index.html" />
    <link rel="prev" title="gossipy documentation" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">gossipy</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api/index.html">
  API documentation
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/makgyver/gossipy" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gossip-learning">
     Gossip Learning
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-up-a-simulation">
   Setting up a simulation
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h1>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">#</a></h2>
<p><strong>gossipy</strong> is available as a <a class="reference external" href="https://pypi.org">PyPI</a> module and it can be installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip install gossipy
</pre></div>
</div>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p><strong>gossipy</strong> is a python module created for research purposes and designed to be used by researchers
and developers. It is thought to be easy-to-use and easy-to-extend.</p>
<p>This framework provides a set of tools for simulating gossip learning and decentralized
federated learning algorithms.</p>
<section id="gossip-learning">
<h3>Gossip Learning<a class="headerlink" href="#gossip-learning" title="Permalink to this headline">#</a></h3>
<p>Gossip Learning (GL) is a distributed (machine) learning methodology based on the idea of spreading
information to other nodes without the need of a centralized server. The name <em>gossip</em> is a reference
to the gossiping mechanism used in ad-hoc networks.</p>
<p>The goal of GL is to train a machine learning model on a data set distributed across several nodes
in a network while keeping the local data private.</p>
<p>In its simplest form, that we call here <em>vanilla</em>, the gossip learning framework can be summarized
as in the following algorithm:</p>
<figure class="align-default" id="gossip-learning-alg">
<a class="reference internal image-reference" href="_images/gl_framework_small.png"><img alt="_images/gl_framework_small.png" src="_images/gl_framework_small.png" style="height: 260px;" /></a>
<figcaption>
<p><span class="caption-text">The <em>vanilla</em> Gossip Learning algorithm.</span><a class="headerlink" href="#gossip-learning-alg" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The algorithm shows what happen on a single node, and we can highlight three important macro steps:</p>
<ol class="arabic simple">
<li><p><strong>model initialization</strong>: (line 1-2) the model is initialized and (potentially) trained on the
local data. This is a one time procedure;</p></li>
<li><p><strong>gossiping</strong>: (line 3-6) the model is repeatedly gossiped to other, usually selected at random,
nodes;</p></li>
<li><p><strong>model update</strong>: (line 7-9) given a just received model, the model is trained on the local data
and set as the new model. Usually, the model update is done by merging the local model with the
received model (merge-update). However, in it simplest form, the model update is done by replacing
the local model with the received model (replace-update).</p></li>
</ol>
</section>
</section>
<section id="setting-up-a-simulation">
<h2>Setting up a simulation<a class="headerlink" href="#setting-up-a-simulation" title="Permalink to this headline">#</a></h2>
<p><strong>gossipy</strong> allows to define a gossip learning simulation easily and quickly. The four main
components that needs to be set up are:</p>
<ul class="simple">
<li><p>a <span class="xref myst">DataHandler</span>: this is the object responsible to handle the dataset.
After the dataset is loaded in memory, the data handler manages the splitting of the dataset
into training and test sets:</p></li>
<li><p>a <span class="xref myst">DataDispatcher</span>: this is the object responsible to dispatch the data across
the clients (i.e., the nodes of the network).</p></li>
<li><p><span class="xref myst">GossipNodes</span>: these are the nodes participating in the simulation. Each node own a model
that is created starting from a <span class="xref myst">ModelHandler</span> prototype. The <span class="xref myst">ModelHandler</span> is the object
responsible to handle the model training and evaluation.</p></li>
<li><p>a <span class="xref myst">GossipSimulation</span>: this is the main object that runs the gossip learning
simulation.</p></li>
</ul>
<p>The following code snippets show how to set up a gossip learning simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following example tries to reproduce one of the experiments reported in the paper</p>
<p>Ormándi, Róbert, István Hegedüs, and Márk Jelasity. <a class="reference external" href="https://doi.org/10.1002/cpe.2858">‘Gossip Learning with Linear Models on
Fully Distributed Data’</a>. Concurrency and Computation:
Practice and Experience 25, no. 4 (February 2013): 556–571.</p>
</div>
<p>Let’s start by loading the dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gossipy.data</span> <span class="kn">import</span> <span class="n">load_classification_dataset</span><span class="p">,</span> <span class="n">DataDispatcher</span>
<span class="kn">from</span> <span class="nn">gossipy.data.handler</span> <span class="kn">import</span> <span class="n">ClassificationDataHandler</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_classification_dataset</span><span class="p">(</span><span class="s2">&quot;spambase&quot;</span><span class="p">,</span> <span class="n">as_tensor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1">#convert 0/1 labels to -1/1</span>
</pre></div>
</div>
<p>Here, we loaded <code class="docutils literal notranslate"><span class="pre">spambase</span></code> dataset as PyTorch tensors. Now, we need a <code class="docutils literal notranslate"><span class="pre">DataHandler</span></code> and a
<code class="docutils literal notranslate"><span class="pre">DataDispatcher</span></code> to manage the distribution of the dataset across the nodes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_handler</span> <span class="o">=</span> <span class="n">ClassificationDataHandler</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">dispatcher</span> <span class="o">=</span> <span class="n">DataDispatcher</span><span class="p">(</span><span class="n">data_handler</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">eval_on_user</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_assign</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>We fixed the test size to 10% of the dataset and we perform global evaluation on a separate test
set, i.e., the nodes do not have local test sets. The number of nodes in the network is 100.
The <code class="docutils literal notranslate"><span class="pre">auto_assign</span></code> parameter is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> because we want just to compute the random
assignment of the dataset to the nodes.</p>
<p>Gossip learning is based on peer-to-peer communication. Therefore, we need a to define the topology
of the network. In this case, we use a fully connected network, thus a clique topology.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">topology</span> <span class="o">=</span> <span class="n">StaticP2PNetwork</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="n">data_dispatcher</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">topology</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>It is called <em>static</em> because the topology is fixed throughout the simulation. Before setting up the
simulation, we need to create the nodes participating in the simulation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_handler</span> <span class="o">=</span> <span class="n">PegasosHandler</span><span class="p">(</span><span class="n">net</span><span class="o">=</span><span class="n">Pegasos</span><span class="p">(</span><span class="n">data_handler</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
                               <span class="n">lam</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span>
                               <span class="n">create_model_mode</span><span class="o">=</span><span class="n">CreateModelMode</span><span class="o">.</span><span class="n">MERGE_UPDATE</span><span class="p">)</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="n">GossipNode</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">data_dispatcher</span><span class="o">=</span><span class="n">data_dispatcher</span><span class="p">,</span>
                            <span class="n">p2p_net</span><span class="o">=</span><span class="n">topology</span><span class="p">,</span>
                            <span class="n">model_proto</span><span class="o">=</span><span class="n">model_handler</span><span class="p">,</span>
                            <span class="n">round_len</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                            <span class="n">sync</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Gossip nodes are created using the <span class="xref myst">GossipNode.generate()</span> method which
generates a number of nodes (corresponding to the size of the network/assignment of the dispatcher)
starting from a prototype. The prototype is actually the model handler that represents the crucial
information of the node. Nodes are created with an incremental id starting from 0. The <code class="docutils literal notranslate"><span class="pre">sync</span></code>
paramenter controls whether the nodes are synchronized or not. Synchronized nodes participate
exactly once every each round.</p>
<p>Now, we can set up the simulation: we set a round length of 100 time units, a PUSH propocol (i.e.,
nodes only send their model to other nodes), and we set to 10% the number of nodes considered during
each evaluation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">GossipSimulator</span><span class="p">(</span>
    <span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
    <span class="n">data_dispatcher</span><span class="o">=</span><span class="n">data_dispatcher</span><span class="p">,</span>
    <span class="n">delta</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">protocol</span><span class="o">=</span><span class="n">AntiEntropyProtocol</span><span class="o">.</span><span class="n">PUSH</span><span class="p">,</span>
    <span class="n">sampling_eval</span><span class="o">=</span><span class="mf">.1</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Finally, we can run the simulation. To keep track of the progress of the simulation, we use a
<span class="xref myst">SimulationReport</span> object that is attached to the simulation. A <code class="docutils literal notranslate"><span class="pre">SimulationReport</span></code> collects the
results and some useful information about the simulation (e.g., number of sent messages,
number of failed messages,…).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">report</span> <span class="o">=</span> <span class="n">SimulationReport</span><span class="p">()</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">add_receiver</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">init_nodes</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">n_rounds</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the simulation is finished, we can access the report object and, for example, plot the
results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_evaluation</span><span class="p">([[</span><span class="n">ev</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">ev</span> <span class="ow">in</span> <span class="n">report</span><span class="o">.</span><span class="n">get_evaluation</span><span class="p">(</span><span class="kc">False</span><span class="p">)]],</span> <span class="s2">&quot;Overall test results&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Mirko Polato.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>